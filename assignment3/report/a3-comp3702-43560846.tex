\title{COMP3702 - Assignment 3}
\author{Roy Portas - 43560846}
\date{\today}

\documentclass[12pt]{article}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{geometry}
\usepackage{listings}
\usepackage{verbatim}
\geometry{
    a4paper,
    margin=1in
}

\begin{document}
    \maketitle

    \section{Problem Definition}

    \subsection{State Space}
    The state space will be a set of tuples of integers from 0 to the maximum number of items the shop can stock. The size of the tuple is the number of items a shop can stock. 
    Thus for a tiny store it will be $\left\{(0, 0), (0, 1), (1, 0), \ldots, (3, 0), (0, 3)\right\}$. Note the sum of the elements in the tuple must be less than or equal to the number of items a store can stock.

    \subsection{Action Space}
    The actions space will be the set of all actions that can be performed by the customers. 
    Thus for a tiny store, it will look like the following:

    \begin{verbatim}
        {
            (buy 0 of item 1, buy 0 of item 2),
            (buy 1 of item 1, buy 0 of item 2),
            ...,
            (buy 2 of item 1, buy 1 of item 2),
            (buy 3 of item 1, buy 0 of item 2)
        }
    \end{verbatim}

    Note that returning an item is represented as buying a negative number of items.

    \subsection{Transition Function}

    The transitions of items are indepedant from each other, meaning that buying one item type does not influence the probability of buying another item type. Thus the transition function for a tiny store can be represented as follows:

    \begin{align*}
        T((i_1, i_2), (t_1, t_2), i_1', i_2') = T_{i_1}(i_1, t_1, i_1) \cdot T_{i_2}(i_2, t_2, i_2)
    \end{align*}

    The transition function will be a matrix for each item type where the rows and columns are the number of items the store stocks.

    \begin{center}
        \begin{tabular} {|c|c|c|c|c|}
            \hline
            Item 1 & 0 & 1 & 2 & 3 \\
            \hline
            0 & 0.2    & 0.3    & 0.2    & 0.3 \\
            1 & 0.4    & 0.1    & 0.2    & 0.3 \\
            2 & 0.1    & 0.5    & 0.2    & 0.2 \\
            3 & 0      & 0.8    & 0.2    & 0   \\
            \hline
        \end{tabular}
    \end{center}

    \begin{center}
        \begin{tabular} {|c|c|c|c|c|}
            \hline
            Item 2 & 0 & 1 & 2 & 3 \\
            \hline
            0 & 0.4    & 0.1    & 0.2    & 0.3 \\
            1 & 0.2    & 0.3    & 0.2    & 0.3 \\
            2 & 0.1    & 0.5    & 0.2    & 0.2 \\
            3 & 0.1    & 0.9  & 0    & 0       \\
            \hline
        \end{tabular}
    \end{center}

    In this table, the rows represent the current state and the columns represent the next state.

    \subsubsection{Implementation Note}

    Create a array of tuples of possible solutions, then run each possibility through the transition function to find the average number of items bought. 
    Add checking to ensure customers can't buy more items than the stores contains.

    Create a class that represents this matrix, ensure that the states are continous, i.e. not discrete (to factor in for returns?). 
    
    Create function to get the bounds of the matrix.

    \subsection{Reward Function}

    The reward function will be the net profit made by the store after performing an action. As with the transition function, the reward for one item type is independant to the reward of other item types.

    \subsection{Discount Factor}

    The discount factor is given in the input file.

    \subsection{Value Function}

    A value function associates a state with the value, or 'worth' of being in that state.

    \begin{align*}
        V_{\pi}(s) = \sum_{s'} T(s, \pi(s), s') \big[ R(s, \pi(s) s') + dV_{\pi}(s') \big]
    \end{align*}

    However since the reward is independant from the next state, the reward function can be represented as $R(s, a)$, yielding:

    \begin{align*}
        V_{\pi}(s) = R(s, \pi(s)) + d\sum_{s'}T(s, \pi{s}, s') V_{\pi}(s')
    \end{align*}

    \subsubsection{Calculating the value function}

    \begin{verbatim}
        def value(action):
            # Calculate the expected number of items sold
            prob = action * transition

            # Calculate the net value of the transactions
            value = prob * item_prices
    \end{verbatim}

    Where action is the tuple containing the the number of items.

    \section{Algorithm Description}

    \subsection{General Explanation}
    \begin{enumerate}
        \item Generate every possible action the customer can take and put it into an array, calculating the cost of any returns done
        \item Run each array through the value function (transition function?) to calculate the profit for the action
        \item Depending on if online or offline, continue building the tree
    \end{enumerate}

    \begin{itemize}
        \item Policy, we are using the Monte Carlo tree to create the policy?
        \item Monte Carlo Tree, edges will be actions and nodes will be profit value
        \item Choose the best node and set that as the root
    \end{itemize}

    \subsection{Online Method}

    Look one step into the Monte Carlo Tree and choose the best result.

    \subsection{Offline Method}


\end{document}
